<Window x:Class="GeneratorSQL.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding Strings[WindowTitle]}" Height="650" Width="950"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top Bar with Language Switcher -->
        <Border Grid.Row="0" 
                Background="{DynamicResource Brush.Surface}" 
                CornerRadius="10" 
                Padding="15,12" 
                Margin="0,0,0,15"
                BorderBrush="{DynamicResource Brush.Border}" 
                BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Text="{Binding Strings[WindowTitle]}" 
                           Grid.Column="0" 
                           FontSize="20" 
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Foreground="{DynamicResource Brush.TextPrimary}"/>
                
                <!-- Language Switcher -->
                <Border Grid.Column="1" 
                        Background="{DynamicResource Brush.SurfaceElevated}" 
                        CornerRadius="20" 
                        Padding="3" 
                        BorderBrush="{DynamicResource Brush.Border}" 
                        BorderThickness="1">
                    <StackPanel Orientation="Horizontal">
                        <!-- EN Button -->
                        <Border x:Name="EnButton" 
                                Background="Transparent"
                                CornerRadius="18" 
                                Padding="16,8" 
                                Cursor="Hand" 
                                MouseDown="OnLanguageClick" 
                                Tag="en">
                            <TextBlock x:Name="EnText" 
                                       Text="ðŸ‡¬ðŸ‡§ EN" 
                                       Foreground="{DynamicResource Brush.TextSecondary}"
                                       FontWeight="SemiBold"/>
                        </Border>
                        <!-- UA Button -->
                        <Border x:Name="UaButton" 
                                Background="Transparent"
                                CornerRadius="18" 
                                Padding="16,8" 
                                Cursor="Hand" 
                                MouseDown="OnLanguageClick" 
                                Tag="uk">
                            <TextBlock x:Name="UaText" 
                                       Text="ðŸ‡ºðŸ‡¦ UA" 
                                       Foreground="{DynamicResource Brush.TextSecondary}"
                                       FontWeight="SemiBold"/>
                        </Border>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content Area (Split View) -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT COLUMN: Config + Output -->
            <Grid Grid.Column="0" Margin="0,0,15,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Configuration Panel -->
                <Border Grid.Row="0" 
                        Background="{DynamicResource Brush.Surface}" 
                        CornerRadius="10" 
                        Padding="15" 
                        Margin="0,0,0,15"
                        BorderBrush="{DynamicResource Brush.Border}" 
                        BorderThickness="1">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Table Name -->
                        <TextBlock Text="{Binding Strings[TableName]}" 
                                   Grid.Row="0" 
                                   Grid.Column="0" 
                                   VerticalAlignment="Center" 
                                   Margin="0,0,10,10"
                                   Foreground="{DynamicResource Brush.TextPrimary}"
                                   FontWeight="SemiBold"/>
                        <TextBox Text="{Binding TableName, UpdateSourceTrigger=PropertyChanged}" 
                                 Grid.Row="0" 
                                 Grid.Column="1" 
                                 Margin="0,0,0,10"/>

                        <!-- SQL Dialect -->
                        <TextBlock Text="{Binding Strings[SqlDialect]}" 
                                   Grid.Row="0" 
                                   Grid.Column="2" 
                                   VerticalAlignment="Center" 
                                   Margin="15,0,10,10"
                                   Foreground="{DynamicResource Brush.TextPrimary}"
                                   FontWeight="SemiBold"/>
                        <ComboBox ItemsSource="{Binding SqlDialects}" 
                                  SelectedItem="{Binding SelectedDialect}"
                                  Grid.Row="0" 
                                  Grid.Column="3" 
                                  Margin="0,0,0,10"/>

                        <!-- Columns -->
                        <TextBlock Text="{Binding Strings[Columns]}" 
                                   Grid.Row="1" 
                                   Grid.Column="0" 
                                   VerticalAlignment="Center" 
                                   Margin="0,0,10,10"
                                   Foreground="{DynamicResource Brush.TextPrimary}"
                                   FontWeight="SemiBold"/>
                        <TextBox Text="{Binding Columns, Mode=OneWay}" 
                                 Grid.Row="1" 
                                 Grid.Column="1" 
                                 Grid.ColumnSpan="3" 
                                 Margin="0,0,0,10"
                                 IsReadOnly="True"
                                 Background="{DynamicResource Brush.SurfaceElevated}"
                                 ToolTip="{Binding Strings[ColumnsTooltip]}"/>

                        <!-- Row Count -->
                        <TextBlock Text="{Binding Strings[RowCount]}" 
                                   Grid.Row="2" 
                                   Grid.Column="0" 
                                   VerticalAlignment="Center" 
                                   Margin="0,0,10,0"
                                   Foreground="{DynamicResource Brush.TextPrimary}"
                                   FontWeight="SemiBold"/>
                        <TextBox Text="{Binding RowCount, UpdateSourceTrigger=PropertyChanged}" 
                                 Grid.Row="2" 
                                 Grid.Column="1" 
                                 Margin="0,0,0,0"/>

                        <!-- Options -->
                        <StackPanel Orientation="Horizontal" 
                                    Grid.Row="2" 
                                    Grid.Column="2" 
                                    Grid.ColumnSpan="2" 
                                    Margin="15,0,0,0"
                                    VerticalAlignment="Center">
                            <CheckBox Content="{Binding Strings[UseDoubleQuotes]}" 
                                      IsChecked="{Binding UseDoubleQuotes}" 
                                      Margin="0,0,20,0" 
                                      VerticalAlignment="Center"
                                      Foreground="{DynamicResource Brush.TextPrimary}"/>
                            <CheckBox Content="{Binding Strings[IncludeCommas]}" 
                                      IsChecked="{Binding IncludeCommas}" 
                                      VerticalAlignment="Center"
                                      Foreground="{DynamicResource Brush.TextPrimary}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Action Buttons -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                    <Button Content="{Binding Strings[GenerateButton]}" 
                            Command="{Binding GenerateCommand}"
                            Margin="0,0,10,0"
                            Padding="20,10"/>
                    
                    <Button Content="{Binding Strings[CopyButton]}" 
                            Command="{Binding CopyToClipboardCommand}"
                            Background="{DynamicResource Brush.SurfaceElevated}"
                            Foreground="{DynamicResource Brush.TextPrimary}"
                            BorderBrush="{DynamicResource Brush.Border}"
                            BorderThickness="1"
                            Margin="0,0,10,0">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource Brush.Accent}" />
                                        <Setter Property="Foreground" Value="White" />
                                        <Setter Property="BorderBrush" Value="{DynamicResource Brush.Accent}" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button Content="{Binding Strings[ClearButton]}" 
                            Command="{Binding ClearCommand}"
                            Background="{DynamicResource Brush.Error}"
                            Foreground="White"
                            Margin="0,0,10,0">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#FFE55555" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <ProgressBar IsIndeterminate="True" 
                                 Visibility="{Binding IsGenerating, Converter={StaticResource BoolToVisibilityConverter}}"
                                 Width="150" 
                                 Height="8" 
                                 VerticalAlignment="Center"
                                 Margin="10,0,0,0"/>
                </StackPanel>

                <!-- Output Area (Expanded) -->
                <Border Grid.Row="2"
                        Background="{DynamicResource Brush.SurfaceElevated}"
                        CornerRadius="8"
                        BorderBrush="{DynamicResource Brush.Border}"
                        BorderThickness="1"
                        Padding="5">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                  HorizontalScrollBarVisibility="Auto">
                        <TextBox Text="{Binding GeneratedOutput, Mode=TwoWay}" 
                                 IsReadOnly="True" 
                                 TextWrapping="NoWrap"
                                 FontFamily="Consolas" 
                                 FontSize="13"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Foreground="{DynamicResource Brush.TextPrimary}"
                                 Padding="10"/>
                    </ScrollViewer>
                </Border>
            </Grid>

            <!-- RIGHT COLUMN: Field Selection -->
            <Border Grid.Column="1" 
                    Background="{DynamicResource Brush.Surface}" 
                    CornerRadius="10" 
                    Padding="15" 
                    BorderBrush="{DynamicResource Brush.Border}" 
                    BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Text="{Binding Strings[SelectFields]}" 
                               Grid.Row="0"
                               FontSize="16" 
                               FontWeight="Bold"
                               Margin="0,0,0,15"
                               Foreground="{DynamicResource Brush.TextPrimary}"/>
                    
                    <TextBox Grid.Row="1"
                             Margin="0,0,0,10"
                             Padding="10,8"
                             Text="{Binding FieldSearchText, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="{Binding Strings[SearchFieldsTooltip]}" />
                             
                    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Padding="0,0,5,0">
                        <ItemsControl ItemsSource="{Binding FieldsView}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" 
                                                       FontWeight="Bold" 
                                                       FontSize="13"
                                                       Margin="0,15,0,5"
                                                       Foreground="{DynamicResource Brush.Accent}"/>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ItemsControl.GroupStyle>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource Brush.SurfaceElevated}" 
                                            CornerRadius="6" 
                                            Padding="10,8" 
                                            Margin="0,2"
                                            BorderBrush="{DynamicResource Brush.Border}" 
                                            BorderThickness="1">
                                        <CheckBox Content="{Binding DisplayName}" 
                                                  IsChecked="{Binding IsSelected}"
                                                  Foreground="{DynamicResource Brush.TextPrimary}"
                                                  FontSize="13"
                                                  ToolTip="{Binding Type}"/>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="{DynamicResource Brush.Surface}" Padding="8,5" Margin="0,10,0,0" BorderBrush="{DynamicResource Brush.Border}" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="{Binding StatusMessage}" Grid.Column="0" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBlock Grid.Column="1" VerticalAlignment="Center" Margin="12,0">
                    <Run Text="Time: "/>
                    <Run Text="{Binding LastGenerationTimeMs}"/>
                    <Run Text="ms"/>
                </TextBlock>
                <StackPanel Orientation="Horizontal" Grid.Column="2" VerticalAlignment="Center">
                    <CheckBox Content="Dark theme" IsChecked="{Binding IsDarkTheme}" VerticalAlignment="Center" Margin="0,0,5,0"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
